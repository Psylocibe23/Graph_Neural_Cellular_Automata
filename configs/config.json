{
  "data": {
    "emojis_dir": "data/emojis",
    "targets": [
      "bacteria.png",
      "heart.png",
      "gecko.png",
      "tooth.png",
      "star.png",
      "smile.png",
      "four_leaf_clover.png",
      "squid.png",
      "eye.png",
      "real_gecko.png"
    ],
    "active_target": "gecko.png",
    "img_size": 40
  },

  "model": {
    "n_channels": 16,

    "perception": { "sobel": true, "identity": true },

    "update_mlp": { "hidden_dim": 128, "layers": 2 },

    "layer_norm": false,
    "fire_rate": 0.5,      
    "update_gain": 0.06,    
    "alpha_thr": 0.25,                  
    "use_groupnorm": true             
  },

  "training": {
    "pool_size": 1024,
    "batch_size": 16,
    "steps_per_epoch": 800,
    "nca_steps_min": 48,
    "nca_steps_max": 80,
    "long_rollout_prob": 0.4,
    "long_rollout_steps_min": 200,
    "long_rollout_steps_max": 400,
    "fire_rate_min": 0.5,
    "fire_rate_max": 0.9,

    "num_epochs": 1000,
    "learning_rate": 0.0002,
    "optimizer": "Adam",
    "weight_decay": 1e-5,
    "gradient_clip": 1.0,
    "loss": "masked_target_mse",
    "loss_alpha_thr": 0.25,
    "loss_lam_area": 8e-4,
    "stability_enabled": true,
    "stability_K": 48,
    "stability_threshold": 0.03,
    "stability_weight": 0.65,
    "reset_worst_prob": 0.10, 
    "random_reseed_prob": 0.05, 
    "loss_lam_bg_alpha": 0.018,
    "loss_lam_bg_rgb": 0.001,
    "scheduler": {
      "type": "StepLR",
      "step_size": 150,
      "gamma": 0.85
    }
  },

  "logging": {
    "checkpoint_interval_epochs": 5,
    "log_interval": 500,
    "save_interval": 1000,
    "results_dir": "outputs",
    "checkpoint_dir": "outputs/checkpoints",
    "visualize_interval": 1000
  },

  "misc": {
    "device": "cuda",
    "seed": 42
  },

  "graph_augmentation": {
    "d_model": 16,
    "attention_radius": 4,
    "num_neighbors": 8,
    "gating_hidden": 32,
    "message_gain": 0.25,  
    "hidden_only": true,   
    "message_rate": 0.2,  
    "message_every": 3    
  },

  "damage": {
  "start_epoch": 100,
  "prob": 0.3,
  "per_sample_prob": 0.4,                 
  "kinds": {                   
    "square": 0.35,
    "circle": 0.25,
    "stripes": 0.10,
    "alpha_drop": 0.15,
    "saltpepper": 0.05,
    "gaussian": 0.10
  },
  "size_min": 6,
  "size_max": 18,
  "stripe_width": 6,
  "alpha_thr": 0.2,
  "alpha_dropout_p": 0.15,
  "salt_pepper_p": 0.02,
  "gaussian_softness": 0.35,
  "hidden_noise_sigma": 0.0
}

}
